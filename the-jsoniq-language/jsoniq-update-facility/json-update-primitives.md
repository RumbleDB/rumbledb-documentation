# JSON update primitives

A Pending Update List is an unordered list of update primitives. Update primitives are internal and do not appear in the syntax. Each kind of update primitive models one individual update to an object or an array.

JSONiq adds the following new update primitives, specific to JSON. They are similar to those defined by the XQuery Update Facility for XML.

Update primitives within a PUL are applied with strict snapshot semantics. For examples, the positions are resolved against the array before the updates. Names are resolved on the object before the updates.

### Update primitive for objects and arrays (in collections or in memory)

<table><thead><tr><th width="282.91796875">Update primitive</th><th>Description</th></tr></thead><tbody><tr><td><p><em>jupd:insert-into-object(</em></p><p>  <em>$target as object(),</em></p><p>  <em>$content as object())</em></p></td><td>Inserts all pairs of the object $content into the object $target.</td></tr><tr><td><p><em>jupd:insert-into-array(</em></p><p>  <em>$target as array(),</em></p><p>  <em>$position as xs:integer,</em></p><p>  <em>$content as item()*)</em></p></td><td>Inserts all items in the sequence $content before position $position into the array $target.</td></tr><tr><td><p><em>jupd:delete-from-object(</em></p><p>  <em>$target as object(),</em></p><p>  <em>$keys as xs:string*)</em></p></td><td>Removes the pairs the names of which appear in $keys from the object $target.</td></tr><tr><td><p><em>jupd:delete-from-array(</em></p><p>  <em>$target as array(),</em></p><p>  <em>$position as xs:integer)</em></p></td><td>Removes the item at position $position from the array $target (causes all following items in the array to move one position to the left).</td></tr><tr><td><p><em>jupd:replace-in-array(</em></p><p>  <em>$target as array(),</em></p><p>  <em>$position as xs:integer,</em></p><p>  <em>$content as item())</em></p></td><td>Replaces the item at position $position in the array $target with the item $content (do nothing if $position is not comprised between 1 and jdm:size($target)).</td></tr><tr><td><p><em>jupd:replace-in-object(</em></p><p>  <em>$target as object(),</em></p><p>  <em>$key as xs:string,</em></p><p>  <em>$content as item())</em></p></td><td>Replaces the value of the pair named $key in the object $target with the item $content (do nothing if there is no such pair).</td></tr><tr><td><p><em>jupd:rename-in-object(</em></p><p>  <em>$target as object(),</em></p><p>  <em>$key as xs:string,</em></p><p>  <em>$content as xs:string)</em></p></td><td>Renames the pair originally named $key in the object $target as $content (do nothing if there is no such pair).</td></tr></tbody></table>

### Update primitives at the collection level

_Credits: Dwij Dixit/Ghislain Fourny (student project at ETH)_

<table><thead><tr><th width="283.4296875">Update primitive</th><th>Description</th></tr></thead><tbody><tr><td><p><em>jupd:create-collection(</em></p><p>  <em>$name as string,</em></p><p>  <em>$mode as string,</em></p><p>  <em>$content as item()*)</em></p></td><td>Creates a collection initialized with the provided items. Mode determines the kind of collection (e.g., a Hive metastore table, a delta lake file, etc).</td></tr><tr><td><p><em>jupd:truncate-collection(</em></p><p>  <em>$name as string,</em></p><p>  <em>$mode as string)</em></p></td><td>Deletes the specified collection.</td></tr><tr><td><p><em>jupd:edit(</em></p><p>  <em>$target as item(),</em></p><p>  <em>$content as item())</em></p></td><td>Modifies an item in a collection into another item, preserving its identity and location.</td></tr><tr><td><p><em>jupd:delete-in-collection(</em></p><p>  <em>$target as item())</em></p></td><td>Deletes the provided item from its collection.</td></tr><tr><td><p><em>jupd:insert-first-into-collection(</em></p><p>  <em>$name as string,</em></p><p>  <em>$mode as string,</em></p><p>  <em>$content as item()*)</em></p></td><td>Inserts the provided items at the very beginning of the specified collection.</td></tr><tr><td><p><em>jupd:insert-last-into-collection(</em></p><p>  <em>$name as string,</em></p><p>  <em>$mode as string,</em></p><p>  <em>$content as item()*)</em></p></td><td>Inserts the provided items at the very end of the specified collection.</td></tr><tr><td><p><em>jupd:insert-before-into-collection(</em></p><p>  <em>$target as item,</em></p><p>  <em>$content as item()*)</em></p></td><td>Inserts the provided items before the specified item in its collection.</td></tr><tr><td><p><em>jupd:insert-last-into-collection(</em></p><p>  <em>$target as item,</em></p><p>  <em>$content as item()*)</em></p></td><td>Inserts the provided items after the specified item in its collection.</td></tr></tbody></table>



\
